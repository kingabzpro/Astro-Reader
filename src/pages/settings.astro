---
import Layout from '../layouts/Layout.astro';
import { getSupabaseClient } from '../lib/supabase.server';
import SettingsPanel from '../components/SettingsPanel.astro';

let settings = null;
if (Astro.locals.session) {
  const supabase = await getSupabaseClient(Astro);
  const { data } = await supabase
    .from('reader_settings')
    .select('*')
    .eq('user_id', Astro.locals.user!.id)
    .single();
  settings = data;
}
---

<Layout title="Settings">
  <div class="settings-page">
    <div class="settings-header">
      <h1>Reader Settings</h1>
      <p>Customize your reading experience</p>
    </div>

    <SettingsPanel settings={settings} client:load />
  </div>
</Layout>

<style>
  .settings-page {
    max-width: 800px;
    margin: 0 auto;
    padding: 3rem 2rem;
  }

  .settings-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .settings-header h1 {
    font-size: 2.5rem;
    margin: 0 0 0.5rem 0;
  }

  .settings-header p {
    color: var(--text-color);
    opacity: 0.7;
    margin: 0;
  }
</style>
